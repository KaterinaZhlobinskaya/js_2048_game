!function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r,n,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var a=[],o=!0,s=!1;try{for(i=i.call(t);!(o=(r=i.next()).done)&&(a.push(r.value),!e||a.length!==e);o=!0);}catch(t){s=!0,n=t}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return a}}(t,e)||r(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){return t.map(function(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||r(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()})}var a=new(function(){var e,r;function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.state=i(t),this.initialState=i(t),this.score=0,this.status="idle"}return e=[{key:"randomNum",value:function(){var t=Object.entries(this.state.flat()).filter(function(t){return 0===n(t,2)[1]}).map(function(t){return n(t,1)[0]});if(0!==t.length){var e=t[Math.floor(Math.random()*t.length)],r=Math.floor(e/this.state.length),i=e%this.state.length;this.state[r][i]=Math.random()>=.9?4:2}}},{key:"mergeArr",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){for(var r=t.length-1;r>0;r--)if(0!==t[r])for(var n=r-1;n>=0;n--){if(t[r]===t[n]){t[r]*=2,t[n]=0,this.score+=t[r];break}if(t[r]!==t[n]&&t[n])break}for(var i=t.length-1;i>0;i--)if(0===t[i]){for(var a=i-1;a>=0;a--)if(0!==t[a]){t[i]=t[a],t[a]=0;break}}}else{for(var o=0;o<t.length-1;o++)if(0!==t[o])for(var s=o+1;s<t.length;s++){if(t[o]===t[s]){t[o]*=2,t[s]=0,this.score+=t[o];break}if(t[o]!==t[s]&&t[s])break}for(var u=0;u<t.length;u++)if(0===t[u]){for(var l=u+1;l<t.length;l++)if(0!==t[l]){t[u]=t[l],t[l]=0;break}}}}},{key:"mergeColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.state.map(function(e){return e[t]});this.mergeArr(r,e),this.state.forEach(function(e,n){e[t]=r[n]})}},{key:"mergeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.state[t];this.mergeArr(r,e)}},{key:"getStrState",value:function(){return this.getState().flat().join()}},{key:"moveIfPlaying",value:function(t){if("playing"===this.status){for(var e=this.getStrState(),r=0;r<this.state.length;r++)t(r);e!==this.getStrState()&&this.randomNum()}}},{key:"moveLeft",value:function(){var t=this;this.moveIfPlaying(function(e){return t.mergeRow(e)})}},{key:"moveRight",value:function(){var t=this;this.moveIfPlaying(function(e){return t.mergeRow(e,!0)})}},{key:"moveUp",value:function(){var t=this;this.moveIfPlaying(function(e){return t.mergeColumn(e)})}},{key:"moveDown",value:function(){var t=this;this.moveIfPlaying(function(e){return t.mergeColumn(e,!0)})}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){if("idle"===this.status)return"idle";if(-1!==this.state.flat().findIndex(function(t){return 2048===t}))return"win";var t=new a(i(this.state));return(t.status="playing",t.moveDown(),t.moveLeft(),t.moveRight(),t.moveUp(),0===t.getScore()&&-1===this.state.flat().findIndex(function(t){return 0===t}))?"lose":this.status}},{key:"start",value:function(){this.randomNum(),this.randomNum(),this.status="playing"}},{key:"restart",value:function(){this.state=i(this.initialState),this.score=0,this.status="idle"}}],t(a.prototype,e),r&&t(a,r),a}()),o=document.querySelector(".game-score"),s=document.querySelector(".message-start"),u=document.querySelector(".message-lose"),l=document.querySelector(".message-win"),f=document.querySelector("button.button"),c=document.querySelectorAll(".field-row"),h=function(){for(var t=a.getState(),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var n=t[e][r],i=c.item(e).children.item(r);i.className="field-cell",i.textContent="",0!==n&&(i.classList.add("field-cell--".concat(n)),i.textContent=n)}},v=function(t){o.innerText=t,o.value=t};document.addEventListener("keydown",function(t){var e=t.key;"idle"!==a.getStatus()&&("lose"===a.getStatus()&&u.classList.remove("hidden"),"win"===a.getStatus()&&l.classList.remove("hidden"),"playing"===a.getStatus()&&("ArrowLeft"===e&&a.moveLeft(),"ArrowRight"===e&&a.moveRight(),"ArrowUp"===e&&a.moveUp(),"ArrowDown"===e&&a.moveDown(),h()),v(a.getScore()))});var m=function(){a.start(),h(),s.classList.add("hidden")},d=function(){a.restart(),h(),v(a.getScore()),u.classList.add("hidden"),l.classList.add("hidden")};f.addEventListener("click",function(t){var e=t.target;d(),m(),e.classList.remove("start"),e.classList.add("restart"),e.innerText="Restart",e.style.fontSize="17px"})}();
//# sourceMappingURL=index.60cf1a22.js.map
